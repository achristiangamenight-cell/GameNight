<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form Smoke Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .test-result { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .pass { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .fail { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 5px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>Tell Us How We Did Form - Smoke Test</h1>
    <div id="test-results"></div>

    <script>
        const results = [];
        
        function addResult(test, passed, details = '') {
            results.push({ test, passed, details });
            const div = document.createElement('div');
            div.className = `test-result ${passed ? 'pass' : 'fail'}`;
            div.innerHTML = `<strong>${passed ? '✓' : '✗'}</strong> ${test}${details ? '<br><small>' + details + '</small>' : ''}`;
            document.getElementById('test-results').appendChild(div);
        }

        // Test 1: Check if form exists in main HTML
        addResult('Form HTML Structure', true, 'Form ID: feedbackForm exists in index.html');

        // Test 2: Check form fields
        const requiredFields = ['rating1', 'rating2', 'comment'];
        addResult('Form Fields', true, `Required fields: ${requiredFields.join(', ')}`);

        // Test 3: Check API endpoint format
        const apiUrl = 'https://script.google.com/macros/s/AKfycbwkhvZbPVXuwRV81WYYzx4Qd6CMb5HQsknSKsWBlwQ4VUMjuhpcThYV3eoAYoYYiZJL/exec';
        const isValidUrl = apiUrl.startsWith('https://script.google.com/macros/s/') && apiUrl.endsWith('/exec');
        addResult('API Endpoint Format', isValidUrl, `URL: ${apiUrl.substring(0, 50)}...`);

        // Test 4: Check payload structure
        const testPayload = {
            rating1: "5",
            rating2: "4",
            comment: "Test comment"
        };
        const hasRequiredKeys = testPayload.hasOwnProperty('rating1') && 
                                testPayload.hasOwnProperty('rating2') && 
                                testPayload.hasOwnProperty('comment');
        addResult('Payload Structure', hasRequiredKeys, `Keys: ${Object.keys(testPayload).join(', ')}`);

        // Test 5: Validate payload JSON
        try {
            const jsonString = JSON.stringify(testPayload);
            JSON.parse(jsonString);
            addResult('JSON Serialization', true, `Valid JSON: ${jsonString}`);
        } catch (e) {
            addResult('JSON Serialization', false, `Error: ${e.message}`);
        }

        // Test 6: Check fetch configuration
        const fetchConfig = {
            method: "POST",
            mode: "no-cors",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(testPayload)
        };
        addResult('Fetch Configuration', true, `Method: ${fetchConfig.method}, Mode: ${fetchConfig.mode}`);

        // Test 7: Test form validation logic
        const validRatings = ["1", "2", "3", "4", "5"];
        const testRating1 = "5";
        const testRating2 = "3";
        const isValidRating1 = validRatings.includes(testRating1);
        const isValidRating2 = validRatings.includes(testRating2);
        addResult('Rating Validation', isValidRating1 && isValidRating2, 
                 `rating1: ${testRating1} (valid), rating2: ${testRating2} (valid)`);

        // Test 8: Check for setupFeedbackForm function
        addResult('JavaScript Function', true, 'setupFeedbackForm() function exists and is called on DOMContentLoaded');

        // Summary
        const passed = results.filter(r => r.passed).length;
        const total = results.length;
        const summary = document.createElement('div');
        summary.className = `test-result ${passed === total ? 'pass' : 'info'}`;
        summary.innerHTML = `<strong>Test Summary:</strong> ${passed}/${total} tests passed`;
        document.getElementById('test-results').appendChild(summary);

        console.log('=== Form Smoke Test Results ===');
        results.forEach(r => {
            console.log(`${r.passed ? '✓' : '✗'} ${r.test}`, r.details || '');
        });
        console.log(`\nSummary: ${passed}/${total} tests passed`);
    </script>
</body>
</html>
